let url,mapsKey;$(document).ready(function(){console.log(sessionStorage)}),$.ajax({url:"config.json",type:"GET",dataType:"json",error:e=>{console.log("There was an issue getting the config file"),console.log(e)},success:e=>{url=`${e.SERVER_URL}:${e.SERVER_PORT}`,mapsKey=e.GOOGLE_MAPS_KEY}}),$("#registerForm").click(()=>{event.preventDefault();let e=!0;const s=$("#registerName").val(),o=$("#registerAddress").val(),n=$("#registerUsername").val(),a=$("#registerPassword").val(),l=$("#registerConfirmPassword").val(),r=$("#registerEmail").val(),t=$("#registerDOB").val();0===s.length&&($("#registerName").addClass("is-invalid"),e=!1),0===o.length&&($("#registerAddress").addClass("is-invalid"),e=!1),0===n.length&&($("#registerUsername").addClass("is-invalid"),e=!1),0===a.length&&($("#registerPassword").addClass("is-invalid"),e=!1),0===l.length&&($("#registerConfirmPassword").addClass("is-invalid"),e=!1),a!==l?($("#registerConfirmPassword").addClass("is-invalid"),$("#registerConfirmPassword").parent().append('<div class="invalid-feedback">Passwords do not match</div>'),e=!1):$("#registerConfirmPassword").parent().children().last().remove(),0===r.length&&($("#registerEmail").addClass("is-invalid"),e=!1),0===t.length&&($("#registerDOB").addClass("is-invalid"),e=!1),e&&$.ajax({url:`${url}/registerUser`,type:"POST",data:{name:s,address:o,username:n,password:a,email:r,dob:t,registerDate:Date.now()},success:e=>{console.log(e),sessionStorage.userId=e._id,sessionStorage.username=e.username,sessionStorage.name=e.name,sessionStorage.email=e.email,sessionStorage.address=e.address},error:e=>{console.log(e),console.log("something went wrong")}})}),$("#listingForm").click(()=>{event.preventDefault();const e=$("#listingTitle").val(),s=$("#listingDescription").val(),o=$("#listingPrice").val();if(0===e.length)console.log("listing title needs an input");else if(0===s.length)console.log("listing description needs an input");else if(0===o.length)console.log("listing price needs an input");else{let n=new FormData;const a=$("#listingImageFile")[0].files[0];n.append("filePath",a),n.append("originalName",a.name),n.append("title",e),n.append("description",s),n.append("price",o),console.log(n),$.ajax({url:`${url}/newListing`,method:"POST",data:n,contentType:!1,processData:!1,success:e=>{console.log("successful")},error:e=>{console.log(e),console.log("did not work")}})}}),$("#loginForm").submit(()=>{event.preventDefault();let e=$("#loginUsername").val(),s=$("#loginPassword").val();0!==e.length&&0!==s.length?$.ajax({url:`${url}/login`,type:"POST",data:{username:e,password:s},error:e=>{console.log("Error logging in"),console.log(e)},success:e=>{console.log(e),sessionStorage.userId=e._id,sessionStorage.username=e.username,sessionStorage.name=e.name,sessionStorage.email=e.email,sessionStorage.address=e.address}}):console.log("You have not filled in all the login inputs")}),$("#logoutBtn").click(()=>{sessionStorage.clear()}),$("#addComment").click(()=>{event.preventDefault();let e=$("#userComment").val();0===e.length?console.log("please enter a comment"):0!==sessionStorage.length?$.ajax({url:`${url}/addAComment`,type:"POST",data:{commentUsername:sessionStorage.username,commentText:e,commentDate:Date.now()},success:e=>{console.log("comment posted")},error:e=>{console.log(e),console.log("did not post comment")}}):console.log("cannot post comment")});